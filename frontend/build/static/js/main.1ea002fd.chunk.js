(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{16:function(e,t,a){e.exports=a.p+"static/media/logo.7baba3c1.svg"},19:function(e,t,a){e.exports=a.p+"static/media/imageSuccess.e38b395c.svg"},20:function(e,t,a){e.exports=a.p+"static/media/imageError.4072126c.svg"},25:function(e,t,a){e.exports=a(99)},33:function(e,t,a){},99:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),c=a(15),r=a.n(c),i=a(7),l=(a(33),a(23)),s=a(2),u=a(1),p=a(16),m=a.n(p);var d=function(e){var t=e.handleLogout,a=e.email;return o.a.createElement("header",{className:"header"},o.a.createElement("img",{className:"header__logo",src:m.a,alt:"\u041b\u043e\u0433\u043e"}),o.a.createElement(u.d,null,o.a.createElement(u.b,{exact:!0,path:"/"},o.a.createElement("div",{className:"header__info"},o.a.createElement("p",{className:"header__email"},a),o.a.createElement(i.b,{to:"/sign-in",onClick:t,className:"header__link"},"\u0412\u044b\u0439\u0442\u0438"))),o.a.createElement(u.b,{path:"/sign-in"},o.a.createElement(i.b,{to:"/sign-up",className:"header__link"},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f")),o.a.createElement(u.b,{path:"/sign-up"},o.a.createElement(i.b,{to:"/sign-in",className:"header__link"},"\u0412\u043e\u0439\u0442\u0438"))))},_=a(9),f=a(11);var h=function(e){var t=e.handleLogin,a=o.a.useState({email:"",password:""}),n=Object(s.a)(a,2),c=n[0],r=n[1];function i(e){var t=e.target,a=t.name,n=t.value;r(Object(f.a)({},c,Object(_.a)({},a,n)))}return o.a.createElement("form",{className:"login",onSubmit:function(e){e.preventDefault();var a=c.email,n=c.password;t(c),console.log(a,n)}},o.a.createElement("h2",{className:"login__title"},"\u0412\u0445\u043e\u0434"),o.a.createElement("input",{className:"login__input login__input_email",type:"email",placeholder:"Email",id:"email",name:"email",value:c.email,onChange:i}),o.a.createElement("input",{className:"login__input login__input_password",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",id:"password",name:"password",value:c.password,onChange:i}),o.a.createElement("button",{className:"login__submit-button",type:"submit"},"\u0412\u043e\u0439\u0442\u0438"))};var E=function(e){var t=e.handleRegister,a=(e.isDataSet,o.a.useState({email:"",password:""})),n=Object(s.a)(a,2),c=n[0],r=n[1];function l(e){var t=e.target,a=t.name,n=t.value;r(Object(f.a)({},c,Object(_.a)({},a,n)))}return o.a.createElement("form",{className:"login",onSubmit:function(e){e.preventDefault();var a=c.email,n=c.password;t({email:a,password:n}),console.log(c)}},o.a.createElement("h2",{className:"login__title"},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"),o.a.createElement("input",{className:"login__input login__input_email",type:"email",placeholder:"Email",id:"email",name:"email",onChange:l,value:c.email}),o.a.createElement("input",{className:"login__input login__input_password",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",id:"password",name:"password",onChange:l,value:c.password}),o.a.createElement("button",{className:"login__submit-button",type:"submit"},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"),o.a.createElement(i.b,{to:"/sign-in",className:"login__link-enter"},"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? \u0412\u043e\u0439\u0442\u0438"))},b=a(19),v=a.n(b),g=a(20),C=a.n(g);var k=function(e){var t=e.isOpen,a=e.onClose,n=e.authStatus;return o.a.createElement("div",{className:"popup ".concat(t?"popup_opened":"")},o.a.createElement("fieldset",{className:"popup__container popup__container_type_info-tooltip"},o.a.createElement("button",{className:"popup__close-button",type:"button",onClick:a}),o.a.createElement("img",{className:"popup__tooltip-image",src:n?v.a:C.a,alt:n?"\u0423\u0441\u043f\u0435\u0445":"\u041e\u0448\u0438\u0431\u043a\u0430"}),o.a.createElement("p",{className:"popup__tooltip-text"},n?"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!":"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437.")))},N=o.a.createContext();var y=function(e){var t=e.onCardClick,a=e.cards,n=e.onCardLike,c=e.onCardDelete,r=o.a.useContext(N),i=a.owner._id===r._id,l="element__delete ".concat(i?"":"element__delete_disabled"),s=a.likes.some(function(e){return e._id===r._id}),u="element__like ".concat(s?"element__like_active":"");return o.a.createElement("article",{className:"element"},o.a.createElement("button",{className:l,type:"button",onClick:function(){c(a)}}),o.a.createElement("img",{className:"element__image",alt:a.name,src:a.link,onClick:function(){t(a)}}),o.a.createElement("div",{className:"element__caption"},o.a.createElement("h2",{className:"element__name"},a.name),o.a.createElement("div",{className:"element__like-counter-container"},o.a.createElement("button",{className:u,type:"button",onClick:function(){n(a)}}),o.a.createElement("p",{className:"element__like-counter"},a.likes.length))))};var O=function(e){var t=e.cards,a=e.onEditAvatar,n=e.onEditProfile,c=e.onAddPlace,r=e.onCardClick,i=e.onCardLike,l=e.onCardDelete,s=o.a.useContext(N);return o.a.createElement("main",{className:"content"},o.a.createElement("section",{className:"profile"},o.a.createElement("div",{className:"profile__avatar-container"},o.a.createElement("img",{className:"profile__avatar",src:s.avatar,alt:"\u0410\u0432\u0430\u0442\u0430\u0440"}),o.a.createElement("button",{className:"profile__avatar-edit",type:"button",onClick:a})),o.a.createElement("div",{className:"profile__info"},o.a.createElement("div",{className:"profile__edit-name"},o.a.createElement("h1",{className:"profile__title"},s.name),o.a.createElement("button",{className:"profile__edit-button",type:"button",onClick:n})),o.a.createElement("p",{className:"profile__subtitle"},s.about)),o.a.createElement("button",{className:"profile__add-button",type:"button",onClick:c})),o.a.createElement("section",{className:"elements"},t.map(function(e){return o.a.createElement(y,{key:e._id,cards:e,onCardClick:r,onCardLike:i,onCardDelete:l})})))};var S=function(){return o.a.createElement("footer",{className:"footer"},o.a.createElement("p",{className:"footer__description"},"\xa9 2022 Mesto Russia"))};var j=function(e){var t=e.card,a=e.onClose;return o.a.createElement("div",{className:"popup popup_type_preview ".concat(t.name?"popup_opened":"")},o.a.createElement("div",{className:"popup__container-preview"},o.a.createElement("button",{className:"popup__close-button",type:"button",onClick:a}),o.a.createElement("img",{className:"popup__preview",src:t.link,alt:t.name}),o.a.createElement("p",{className:"popup__subtitle"},t.name)))};var w=function(e){var t=e.isOpen,a=e.onClose,n=e.name,c=e.title,r=e.buttonText,i=e.children,l=e.onSubmit;return o.a.createElement("div",{className:"popup ".concat(n," ").concat(t?"popup_opened":"")},o.a.createElement("form",{name:"".concat(n),className:"popup__container",onSubmit:l},o.a.createElement("button",{type:"button",className:"popup__close-button",onClick:a}),o.a.createElement("h2",{className:"popup__title"},"".concat(c)),i,o.a.createElement("button",{type:"submit",className:"popup__save-button",title:"".concat(r)},"".concat(r))))};var T=function(e){var t=e.isOpen,a=e.onClose,n=e.onUpdateUser,c=o.a.useContext(N),r=o.a.useState(""),i=Object(s.a)(r,2),l=i[0],u=i[1],p=o.a.useState(""),m=Object(s.a)(p,2),d=m[0],_=m[1];return o.a.useEffect(function(){u(c.name),_(c.about)},[c,t]),o.a.createElement(w,{name:"popup__form_submit",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",buttonTitle:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),n({name:l,about:d})},buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"},o.a.createElement("input",{type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f",className:"popup__input popup__input_type_job",name:"name",id:"name-input",value:l,onChange:function(e){u(e.target.value)}}),o.a.createElement("input",{type:"text",placeholder:"\u041e \u0441\u0435\u0431\u0435",className:"popup__input popup__input_type_job",name:"about",id:"job-input",value:d,onChange:function(e){_(e.target.value)}}))};var x=function(e){var t=e.isOpen,a=e.onClose,n=e.onUpdateUser,c=(e.isLoading,o.a.useRef());return o.a.useEffect(function(){c.current.value=""},[t]),o.a.createElement(w,{name:"popup__form_avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",buttonTitle:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),n({avatar:c.current.value})},buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"},o.a.createElement("input",{type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0442\u0430\u0440",className:"popup__input popup__input_type_avatar",name:"avatar-input",id:"avatar-input",ref:c}))};var L=function(e){var t=e.isOpen,a=e.onClose,n=e.onAddPlace,c=o.a.useState(""),r=Object(s.a)(c,2),i=r[0],l=r[1],u=o.a.useState(""),p=Object(s.a)(u,2),m=p[0],d=p[1];return o.a.useEffect(function(){l(""),d("")},[t]),o.a.createElement(w,{name:"add",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",buttonTitle:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),n({name:i,link:m})},buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"},o.a.createElement("input",{type:"text",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",className:"popup__input popup__input_type_name-place",name:"popup__input_name-place",id:"place-input",value:i,onChange:function(e){l(e.target.value)}}),o.a.createElement("input",{type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"popup__input popup__input_type_link-place",name:"popup__input_link-place",id:"link-input",value:m,onChange:function(e){d(e.target.value)}}))},P=a(21),A=a(22),D=new(function(){function e(t){var a=this,n=t.url,o=t.headers;Object(P.a)(this,e),this.getUserInfo=function(){return fetch("".concat(a._url,"/users/me"),{headers:a._headers}).then(function(e){return a._checkResult(e)})},this.patchUserInfo=function(e,t){return fetch("".concat(a._url,"/users/me"),{method:"PATCH",headers:a._headers,body:JSON.stringify({name:e,about:t})}).then(function(e){return a._checkResult(e)})},this.getCards=function(){return fetch("".concat(a._url,"/cards"),{headers:a._headers}).then(function(e){return a._checkResult(e)})},this.postCard=function(e,t){return fetch("".concat(a._url,"/cards"),{method:"POST",headers:a._headers,body:JSON.stringify({name:e,link:t})}).then(function(e){return a._checkResult(e)})},this.likeCard=function(e,t){return fetch("".concat(a._url,"/cards/").concat(e,"/likes"),{method:t?"PUT":"DELETE",headers:a._headers}).then(function(e){return a._checkResult(e)})},this.deleteCard=function(e){return fetch("".concat(a._url,"/cards/").concat(e),{method:"DELETE",headers:a._headers}).then(function(e){return a._checkResult(e)})},this.editAvatar=function(e){return fetch("".concat(a._url,"/users/me/avatar"),{method:"PATCH",headers:a._headers,body:JSON.stringify({avatar:e})}).then(function(e){return a._checkResult(e)})},this._url=n,this._headers=o}return Object(A.a)(e,[{key:"_checkResult",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.statusText))}}]),e}())({url:"http://api.mesto-avtor-Hohlov-Al.nomoredomains.club",headers:{"Content-type":"application/json",authorization:"Bearer ".concat(localStorage.getItem("token"))}}),I="http://api.mesto-avtor-Hohlov-Al.nomoredomains.club",U=function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))},R=function(e,t){return fetch("".concat(I,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then(U)},J=function(e,t){return fetch("".concat(I,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then(U)},B=function(e){return fetch("".concat(I,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then(U)},F=a(24),H=function(e){var t=e.component,a=Object(F.a)(e,["component"]);return o.a.createElement(u.b,null,function(){return!0===a.loggedIn?o.a.createElement(t,a):o.a.createElement(u.a,{to:"./sign-in"})})};var z=function(){var e=o.a.useState(!1),t=Object(s.a)(e,2),a=t[0],n=t[1],c=o.a.useState(!1),r=Object(s.a)(c,2),i=r[0],p=r[1],m=o.a.useState(!1),_=Object(s.a)(m,2),f=_[0],b=_[1],v=o.a.useState(!1),g=Object(s.a)(v,2),C=g[0],y=g[1],w=o.a.useState(!1),P=Object(s.a)(w,2),A=P[0],I=P[1],U=o.a.useState([]),F=Object(s.a)(U,2),z=F[0],M=F[1],G=o.a.useState({name:"",link:"",alt:""}),q=Object(s.a)(G,2),K=q[0],Q=q[1],V=o.a.useState({name:"",about:"",avatar:""}),W=Object(s.a)(V,2),X=W[0],Y=W[1],Z=o.a.useState(!1),$=Object(s.a)(Z,2),ee=$[0],te=$[1],ae=o.a.useState(!1),ne=Object(s.a)(ae,2),oe=ne[0],ce=ne[1],re=o.a.useState({email:""}),ie=Object(s.a)(re,2),le=ie[0],se=ie[1],ue=Object(u.g)();o.a.useEffect(function(){ee&&Promise.all([D.getUserInfo(),D.getCards()]).then(function(e){var t=Object(s.a)(e,2),a=t[0],n=t[1];Y(a),M(n),ue.push("/")}).catch(function(e){return console.log(e)})},[ee]);var pe=a||i||f||K.link||C;o.a.useEffect(function(){function e(e){"Escape"===e.key&&me()}if(pe)return document.addEventListener("keydown",e),document.addEventListener("click",de),function(){document.removeEventListener("keydown",e),document.removeEventListener("click",de)}},[pe]),o.a.useEffect(function(){ee&&ue.push("/")},[ue,ee]),o.a.useEffect(function(){!function(){var e=localStorage.getItem("token");e&&B(e).then(function(e){e&&(se({email:e.data.email}),te(!0))}).catch(function(e){return console.log(e)})}()},[]);var me=function(){n(!1),p(!1),b(!1),Q({name:"",link:""}),y(!1)};function de(e){e.target.classList.contains("popup")&&me()}return o.a.createElement(N.Provider,{value:X},o.a.createElement("div",{className:"page"},o.a.createElement(d,{loggedIn:ee,handleLogout:function(){localStorage.removeItem("token"),se({email:""}),te(!1)},email:le.email}),o.a.createElement(u.d,null,o.a.createElement(H,{loggedIn:ee,exact:!0,path:"/",cards:z,onEditAvatar:function(){n(!0)},onEditProfile:function(){p(!0)},onAddPlace:function(){b(!0)},onCardClick:function(e){Q(e)},onCardLike:function(e){var t=e.likes.some(function(e){return e._id===X._id});D.likeCard(e._id,!t).then(function(t){M(function(a){return a.map(function(a){return a._id===e._id?t:a})})}).catch(function(e){return console.log(e)})},onCardDelete:function(e){D.deleteCard(e._id).then(function(){M(function(t){return t.filter(function(t){return t._id!==e._id&&t})})}).catch(function(e){return console.log(e)})},component:O}),o.a.createElement(u.b,{path:"/sign-in"},o.a.createElement(h,{handleLogin:function(e){var t=e.email,a=e.password;J(t,a).then(function(e){e.token&&(localStorage.setItem("token",e.token),se({email:t}),te(!0),ue.push("/"))}).catch(function(e){ue.push("/sign-in"),I(!0),console.log(e)})}})),o.a.createElement(u.b,{path:"/sign-up"},o.a.createElement(E,{handleRegister:function(e){var t=e.email,a=e.password;console.log(t,a),R(t,a).then(function(e){e.data._id&&(ce(!0),ue.push("/sign-in"),I(!0))}).catch(function(e){ce(!1),I(!1),y(!0)}).finally(function(){ce(!1),y(!0)})},isDataSet:oe})),o.a.createElement(u.b,{path:"*"},ee?o.a.createElement(u.a,{to:"/"}):o.a.createElement(u.a,{to:"/sign-in"}))),o.a.createElement(S,null),o.a.createElement(x,{isOpen:a,onClose:me,onUpdateUser:function(e){D.editAvatar(e.avatar).then(function(e){Y(e),me()}).catch(function(e){return console.log(e)})}}),o.a.createElement(T,{isOpen:i,onClose:me,onUpdateUser:function(e){D.patchUserInfo(e.name,e.about).then(function(e){Y(e),me()}).catch(function(e){return console.log(e)})}}),o.a.createElement(L,{isOpen:f,onClose:me,onAddPlace:function(e){D.postCard(e.name,e.link).then(function(e){M([e].concat(Object(l.a)(z))),me()}).catch(function(e){return console.log(e)})}}),o.a.createElement(j,{card:K,onClose:me}),o.a.createElement(k,{isOpen:C,onClose:me,authStatus:A})))},M=function(e){e&&e instanceof Function&&a.e(1).then(a.bind(null,100)).then(function(t){var a=t.getCLS,n=t.getFID,o=t.getFCP,c=t.getLCP,r=t.getTTFB;a(e),n(e),o(e),c(e),r(e)})};r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(i.a,null,o.a.createElement(z,null))),document.getElementById("root")),M()}},[[25,3,2]]]);
//# sourceMappingURL=main.1ea002fd.chunk.js.map